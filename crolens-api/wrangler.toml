name = "crolens-api"
main = "build/worker/shim.mjs"
compatibility_date = "2024-01-01"

[build]
command = "cargo install -q worker-build && worker-build --release"
watch_dir = ["src"]

[vars]
CRONOS_CHAIN_ID = "25"
MULTICALL3_ADDRESS = "0xcA11bde05977b3631167028862bE2a173976CA11"
RPC_MAX_RETRIES = "3"
RATE_LIMIT_JSONRPC_PER_MIN = "120"
RATE_LIMIT_JSONRPC_WINDOW_SECS = "60"

# Declare sensitive vars so they can be overridden in `.dev.vars` during local development.
# For production, set these via `wrangler secret put` or the Cloudflare dashboard instead.
BLOCKPI_RPC_URL = ""
TENDERLY_API_KEY = ""
TENDERLY_ACCESS_KEY = ""
TENDERLY_ACCOUNT = ""
TENDERLY_PROJECT = ""

# x402 payment config (public values).
X402_PAYMENT_ADDRESS = ""
X402_TOPUP_CREDITS = "1000"

# Optional: restrict CORS in production (e.g. https://crolens.example.com).
CORS_ALLOW_ORIGIN = ""

[triggers]
crons = ["*/5 * * * *"]

[[kv_namespaces]]
binding = "KV"
id = "827c10be6ddf413f844d3fc445a9df6e"

[[d1_databases]]
binding = "DB"
database_name = "crolens-db"
database_id = "1018a32d-0ad4-4181-9df5-1ea86f86098a"
